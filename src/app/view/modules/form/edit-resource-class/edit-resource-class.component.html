<section *ngIf="!editResource">
    <h3>{{resType.label}}</h3>
    <p>{{resType.description}}</p>
    <form>
        <mat-list class="list-group" matTooltip="You can sort this list with drag and drop" dnd-sortable-container
                  [sortableData]="resType.properties">

            <!--TODO assign i to prop.guiorder  -->

            <mat-list-item *ngFor="let prop of resType.properties; let i = index"
                           class="list-group-item"
                           dnd-sortable [sortableIndex]="i">
                <h4 mat-line>{{prop.label}}</h4>
                <p mat-line>{{prop.description}}</p>
                <p mat-line>{{prop.occurrence}} | {{prop.gui_name}}</p>
            </mat-list-item>
        </mat-list>
    </form>
    <mat-divider></mat-divider>
    <p class="mute">My classes:<br/>
        <span *ngFor="let prop of resType.properties; let i = index">{{i + 1}}) {{prop.label}}<br/></span>

</section>

<!------------------------------------------------------------------------------------------------------->
<!------------------------------------Edit resources!    ------------------------------------------------>
<!------------------------------------------------------------------------------------------------------->

<section *ngIf="editResource">
    <p>Click on the arrows to expand and edit</p>

    <!------------------------------------------------------------------------------------------------------->
    <!-----------Here we will use cards for each resource and property, which will be collapsible------------>
    <!-----------Each card will have its own save button----------------------------------------------------->


    <mat-card>
        <mat-card-header>
            <h4>Resource: {{resType.label}}</h4>
            <span *ngIf="focusOnResourceEdit=='inactive'">
                        <button mat-icon-button (click)="toggleMenu('resEdit')">
                            <mat-icon>keyboard_arrow_down</mat-icon>
                        </button>
                    </span>
            <span *ngIf="focusOnResourceEdit=='active'">
                        <button mat-icon-button (click)="toggleMenu('resEdit')">
                            <mat-icon>keyboard_arrow_up</mat-icon>
                        </button>
                    </span>
        </mat-card-header>
        <form #editRes="ngForm" (ngSubmit)="onSubmit(editRes.value)" class="salsah-form">
            <!-- toggle only card content -->
            <div [@resEdit]="focusOnResourceEdit">
                <mat-card-content>
                    <p>
                        <mat-input-container class="full-width">
                            <input matInput
                                   placeholder="Resource Type"
                                   name="name"
                                   [(ngModel)]="resType.label"
                                   value="{{resType.label}}">
                        </mat-input-container>
                    </p>

                    <p>
                        <mat-input-container class="full-width">
                                    <textarea matInput
                                              placeholder="Resource Description"
                                              name="description"
                                              [(ngModel)]="resType.description">
                                        {{resType.description}}
                                    </textarea>
                        </mat-input-container>
                    </p>
                </mat-card-content>

                <mat-card-actions>
                    <button mat-raised-button
                            class="save-button"
                            [color]="'primary'"
                            type="submit">
                        Save
                    </button>
                </mat-card-actions>
            </div>
        </form>
    </mat-card>


    <!------------------------------------Edit resource properties!  We use tabs  ------------------------------------------------>
    <br>
    <mat-card>
        <mat-card-header>
            <h4>Resource properties</h4>
            <span *ngIf="focusOnPropertiesEdit=='inactive'">
                        <button mat-icon-button (click)="toggleMenu('propEdit')">
                            <mat-icon>keyboard_arrow_down</mat-icon>
                        </button>
                    </span>
            <span *ngIf="focusOnPropertiesEdit=='active'">
                        <button mat-icon-button (click)="toggleMenu('propEdit')">
                            <mat-icon>keyboard_arrow_up</mat-icon>
                        </button>
                    </span>
        </mat-card-header>
        <!-- toggle only card content -->
        <div [@propEdit]="focusOnPropertiesEdit">
            <mat-tab-group>
                <!-- use tabs to go through the different properties -->
                <mat-tab *ngFor="let prop of resType.properties; let i = index" label="{{prop.label}}">
                    <form #editProp="ngForm" (ngSubmit)="onSubmit(editProp.value)" class="salsah-form">
                        <br>
                        <mat-card-content>
                            <!-- each property can be modified (some fields are disabled since they should not be modified) -->
                            <mat-input-container class="full-width">
                                <input matInput
                                       placeholder="Property name"
                                       name="propertyName"
                                       [id]="prop.label"
                                       [(ngModel)]="prop.label"
                                       [value]="prop.label">
                            </mat-input-container>
                            <mat-input-container class="full-width">
                                <input matInput
                                       placeholder="Property description"
                                       name="propDescription"
                                       [id]="prop.description"
                                       [(ngModel)]="prop.description"
                                       [value]="prop.description">
                            </mat-input-container>
                            <mat-select class="full-width"
                                        placeholder="GUI type (!!!does not show original value yet)"
                                        [(ngModel)]="prop.gui_name"
                                        name="GUI type"
                                        (change)="setGUI(i, $event)">
                                <mat-option *ngFor="let guiItem of guiItems" [value]="guiItem">
                                    {{guiItem}}
                                </mat-option>
                            </mat-select>
                            <br><br>
                            <mat-input-container class="full-width">
                                <input matInput
                                       placeholder="Attributes"
                                       name="attributes"
                                       [id]="prop.attributes"
                                       [(ngModel)]="prop.attributes"
                                       [value]="prop.attributes">
                            </mat-input-container>
                            <mat-input-container class="full-width">
                                <input matInput
                                       placeholder="Id"
                                       name="id"
                                       [id]="prop.id"
                                       [(ngModel)]="prop.id"
                                       disabled value="prop.id">
                            </mat-input-container>
                            <mat-select class="full-width"
                                        placeholder="Occurrence"
                                        [(ngModel)]="prop.occurrence"
                                        name="Occurrence"
                                        (change)="setOcc(i, $event)">
                                <mat-option *ngFor="let cardinality of cardinalityList;" [value]="cardinality">
                                    {{cardinality}}
                                </mat-option>
                            </mat-select>
                            <br><br>
                            <mat-input-container class="full-width">
                                <input matInput
                                       placeholder="Value type id"
                                       name="valuetype_id"
                                       [id]="prop.valuetype_id"
                                       [(ngModel)]="prop.valuetype_id"
                                       disabled value="prop.valuetype_id">
                            </mat-input-container>
                            <mat-select class="full-width"
                                        placeholder="Vocabulary"
                                        [(ngModel)]="prop.vocabulary"
                                        name="Vocabulary"
                                        (change)="setVoc(i, $event)"
                                        disabled>
                                <mat-option *ngFor="let project of projectsList" [value]="project.ontologyNamedGraph">
                                    {{project.name}}
                                </mat-option>
                            </mat-select>
                            <br><br>
                        </mat-card-content>

                        <mat-card-actions>
                            <button mat-raised-button
                                    class="save-button"
                                    [color]="'primary'"
                                    type="submit">
                                Save
                            </button>
                        </mat-card-actions>
                    </form>
                </mat-tab>
            </mat-tab-group>
        </div>
    </mat-card>
</section>


<footer class="footer">
    <div *ngIf="!editResource" layout="row" layout-align="center center" flex>
        <button mat-raised-button
                class="next"
                [color]="'primary'"
                (click)="editResources()">
            Edit
        </button>
    </div>
    <div *ngIf="editResource" layout="row" layout-align="center center" flex>
        <button mat-raised-button
                class="next"
                [color]="'primary'"
                (click)="closeEditView()">
            Close
        </button>
    </div>
</footer>
