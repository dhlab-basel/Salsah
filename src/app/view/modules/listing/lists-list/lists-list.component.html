<!-- progress indicator while the data is loading -->
<salsah-progress-indicator *ngIf="isLoading && !errorMessage"></salsah-progress-indicator>

<!-- show the results -->
<div *ngIf="!isLoading && !errorMessage; else errorMsg">

    <!-- if we have the data: show the list-->
    <div class="fill-remaining-space" *ngIf="numberOfItems > 0; else noData">

        <mat-accordion>
            <mat-expansion-panel *ngFor="let item of lists; let i = index" [hideToggle]="true"
                                 (opened)="fetchListData(item.id)">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        <span matTooltip="Click on the list name to see nodes">
                            <h4>{{item.labels[0].value}}</h4>
                        </span>
                    </mat-panel-title>
                    <mat-panel-description>
                        {{item.id}}
                        <mat-icon>list</mat-icon>
                    </mat-panel-description>
                </mat-expansion-panel-header>

                <span><b>{{listLists.nodesLabel}}</b>
                    <span class="subtitle">Click on the node name to edit the node</span>
                </span>
                <salsah-progress-indicator *ngIf="isLoadingNodes"></salsah-progress-indicator>
                <div *ngIf="currentListInfo" #tree>
                    <button class="right" mat-button color="primary" *ngIf="!isExpanded" (click)="expandAll(tree)">
                        {{listLists.buttons.expand}}
                    </button>
                    <button class="right" mat-button color="primary" *ngIf="isExpanded" (click)="collapseAll(tree)">
                        {{listLists.buttons.collapse}}
                    </button>
                    <tree-root class="tree-node-expanded" #tree [nodes]="currentNodes" [options]="options">
                        <ng-template #treeNodeTemplate let-node let-index="index">
                            <span *ngIf="node.children.length == 0" matTooltip="Click on the node name to edit">
                                <span (click)="edit(item.id, node.data)">
                                    {{ node.data.name }}
                                </span>
                            </span>
                            <span *ngIf="node.children.length != 0" matTooltip="Click arrow to see children, or node name to edit">
                                <span (click)="edit(item.id, node.data)">
                                    {{ node.data.name }}
                                </span>
                            </span>
                            <span class="subtitle" *ngIf="node.children.length != 0"> Number of sub-nodes: {{node.children.length}}</span>


                            <!--     <button>{{node.data.name}}</button>
                               <button (click)="viewDetails(node.data.id)">Node Name</button>
                              -->
                        </ng-template>
                    </tree-root>

                    <!--TODO: move button above next to "Nodes" title-->
                </div>
                <!--
                              <mat-action-row>
                                  <button mat-button
                                          color="primary"
                                          (click)="toggle(item?.id, i)">
                                      {{listLists.buttons.edit}}
                                  </button>
                              </mat-action-row>

                                          <mat-action-row>
                                              <button mat-button
                                                      color="primary"
                                                      (click)="edit(item?.id)">
                                                  edit
                                              </button>
                                          </mat-action-row>
                              -->
            </mat-expansion-panel>

        </mat-accordion>
    </div>

    <!-- in the case of zero results: show a no data message -->
    <ng-template #noData>
        <salsah-message [message]="noDataMessage"></salsah-message>
    </ng-template>
</div>

<!-- in the case of an API error: show the error message -->
<ng-template #errorMsg>
    <salsah-message *ngIf="errorMessage" [message]="errorMessage"></salsah-message>
</ng-template>


<!--
<!-- single list operations --
<div *ngIf="listOp === 'view' || listOp === 'edit' || listOp === 'create'"
     class="salsah-module-detail"
     [ngClass]="position.detail">
    <mat-progress-bar mode="indeterminate" *ngIf="isLoadingSubModule"></mat-progress-bar>

    <div class="salsah-module-detail-header">
        <!-- close button --
        <button mat-mini-fab (click)="closeDetailView()">
            <mat-icon>close</mat-icon>
        </button>
    </div>

</div>


    <div class="salsah-module-detail-content">
        <!-- if an error occurs: show the error message --
<salsah-message *ngIf="errorMessage" [message]="errorMessage"></salsah-message>

<!-- view selected list --
<div class="view-list" *ngIf="!errorMessage">
    <salsah-list-form [listIri]="selectedList.id" [listOp]="listOp"></salsah-list-form>
</div>
</div>
-->

